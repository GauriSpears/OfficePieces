# OfficePieces
various useful MS office stuff

Нормальный формат даты при слиянии  
{MERGEFIELD имя_поля\@ "dd.MM.yyyy"}

Разбиение документа на несколько с сохранением форматирования  
WordDocSplit.vba  
Задать в iStep по сколько страниц разбивать  
Задать правило именования создаваемых документов в strNewFileName  

Склонение фраз  
Sklon.vba  

Сумма прописью  
=ЕСЛИ(G2=0;"ноль";СЖПРОБЕЛЫ(ВЫБОР((ОСТАТ(G2;1000000000)-ОСТАТ(G2;100000000))/100000000+1;"";"сто";"двести";"триста";"четыреста";"пятьсот";"шестьсот";"семьсот";"восемьсот";"девятьсот") & " " & ВЫБОР(ЕСЛИ(ОСТАТ(G2;100000000)<20000000;1;(ОСТАТ(G2;100000000)-ОСТАТ(G2;10000000))/10000000);"";"двадцать";"тридцать";"сорок";"пятьдесят";"шестьдесят";"семьдесят";"восемьдесят";"девяносто") & " " & ВЫБОР((ЕСЛИ(ОСТАТ(G2;100000000)<19999999;ОСТАТ(G2;100000000);ОСТАТ(G2;10000000))-ОСТАТ(G2;1000000))/1000000+1;"";"одна";"две";"три";"четыре";"пять";"шесть";"семь";"восемь";"девять";"десять";"одиннадцать";"двенадцать";"тринадцать";"четырнадцать";"пятнадцать";"шестнадцать";"семнадцать";"восемнадцать";"девятнадцать") & " " & ЕСЛИ(G2<1000000;"";ЕСЛИ((ЕСЛИ(ОСТАТ(G2;100000000)<20000000;ОСТАТ(G2;100000000);ОСТАТ(G2;10000000))-ОСТАТ(G2;1000000))/1000000=1;"миллион";ЕСЛИ(И((ЕСЛИ(ОСТАТ(G2;100000000)<20000000;ОСТАТ(G2;100000000);ОСТАТ(G2;10000000))-ОСТАТ(G2;1000000))/1000000>1;(ЕСЛИ(ОСТАТ(G2;100000000)<20000000;ОСТАТ(G2;100000000);ОСТАТ(G2;10000000))-ОСТАТ(G2;1000000))/1000000<5);"миллиона";"миллионов"))) & " " & ВЫБОР((ОСТАТ(G2;1000000)-ОСТАТ(G2;100000))/100000+1;"";"сто";"двести";"триста";"четыреста";"пятьсот";"шестьсот";"семьсот";"восемьсот";"девятьсот") & " " & ВЫБОР(ЕСЛИ(ОСТАТ(G2;100000)<20000;1;(ОСТАТ(G2;100000)-ОСТАТ(G2;10000))/10000);"";"двадцать";"тридцать";"сорок";"пятьдесят";"шестьдесят";"семьдесят";"восемьдесят";"девяносто") & " " & ВЫБОР((ЕСЛИ(ОСТАТ(G2;100000)<19999;ОСТАТ(G2;100000);ОСТАТ(G2;10000))-ОСТАТ(G2;1000))/1000+1;"";"одна";"две";"три";"четыре";"пять";"шесть";"семь";"восемь";"девять";"десять";"одиннадцать";"двенадцать";"тринадцать";"четырнадцать";"пятнадцать";"шестнадцать";"семнадцать";"восемнадцать";"девятнадцать") & " " & ЕСЛИ(G2<1000;"";ЕСЛИ((ЕСЛИ(ОСТАТ(G2;100000)<20000;ОСТАТ(G2;100000);ОСТАТ(G2;10000))-ОСТАТ(G2;1000))/1000=1;"тысяча";ЕСЛИ(И((ЕСЛИ(ОСТАТ(G2;100000)<20000;ОСТАТ(G2;100000);ОСТАТ(G2;10000))-ОСТАТ(G2;1000))/1000>1;(ЕСЛИ(ОСТАТ(G2;100000)<20000;ОСТАТ(G2;100000);ОСТАТ(G2;10000))-ОСТАТ(G2;1000))/1000<5);"тысячи";"тысяч"))) & " " & ВЫБОР((ОСТАТ(G2;1000)-ОСТАТ(G2;100))/100+1;"";"сто";"двести";"триста";"четыреста";"пятьсот";"шестьсот";"семьсот";"восемьсот";"девятьсот") & " " & ВЫБОР(ЕСЛИ(ОСТАТ(G2;100)<20;1;(ОСТАТ(G2;100)-ОСТАТ(G2;10))/10);"";"двадцать";"тридцать";"сорок";"пятьдесят";"шестьдесят";"семьдесят";"восемьдесят";"девяносто") & " " & ВЫБОР(ЕСЛИ(ОСТАТ(G2;100)<20;ОСТАТ(G2;100);ОСТАТ(G2;10))+1;"";"один";"два";"три";"четыре";"пять";"шесть";"семь";"восемь";"девять";"десять";"одиннадцать";"двенадцать";"тринадцать";"четырнадцать";"пятнадцать";"шестнадцать";"семнадцать";"восемнадцать";"девятнадцать"))) & " руб. " & ТЕКСТ((G2-ЦЕЛОЕ(G2))*100;"00") & " коп."
